{"remainingRequest":"D:\\PTUD_Web\\PhamGiaHung_B2111845_CT44901_BaiTapLon\\CTT449-BaiTapLon\\front-end\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\PTUD_Web\\PhamGiaHung_B2111845_CT44901_BaiTapLon\\CTT449-BaiTapLon\\front-end\\src\\components\\books\\BookList.vue?vue&type=script&lang=js","dependencies":[{"path":"D:\\PTUD_Web\\PhamGiaHung_B2111845_CT44901_BaiTapLon\\CTT449-BaiTapLon\\front-end\\src\\components\\books\\BookList.vue","mtime":1742724685983},{"path":"D:\\PTUD_Web\\PhamGiaHung_B2111845_CT44901_BaiTapLon\\CTT449-BaiTapLon\\front-end\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1742719098262},{"path":"D:\\PTUD_Web\\PhamGiaHung_B2111845_CT44901_BaiTapLon\\CTT449-BaiTapLon\\front-end\\node_modules\\vue-loader\\lib\\index.js","mtime":1742719098071}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQppbXBvcnQgYXBpIGZyb20gJ0AvYXBpJzsNCmltcG9ydCBhdXRoU2VydmljZSBmcm9tICdAL3NlcnZpY2VzL2F1dGguc2VydmljZSc7DQoNCmV4cG9ydCBkZWZhdWx0IHsNCiAgICBkYXRhKCkgew0KICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgYm9va3M6IFtdLA0KICAgICAgICAgICAgZmllbGRzOiBbDQogICAgICAgICAgICAgICAgeyBrZXk6ICdNYVNhY2gnLCBsYWJlbDogJ03DoyBzw6FjaCcgfSwNCiAgICAgICAgICAgICAgICB7IGtleTogJ1RlblNhY2gnLCBsYWJlbDogJ1TDqm4gc8OhY2gnIH0sDQogICAgICAgICAgICAgICAgeyBrZXk6ICdUYWNHaWEnLCBsYWJlbDogJ1TDoWMgZ2nhuqMnIH0sDQogICAgICAgICAgICAgICAgeyBrZXk6ICdIaW5oQW5oJywgbGFiZWw6ICdIw6xuaCDhuqNuaCcgfSwNCiAgICAgICAgICAgICAgICB7IGtleTogJ2FjdGlvbnMnLCBsYWJlbDogJ0jDoG5oIMSR4buZbmcnIH0NCiAgICAgICAgICAgIF0sDQogICAgICAgICAgICBpc0FkbWluOiBmYWxzZQ0KICAgICAgICB9Ow0KICAgIH0sDQogICAgYXN5bmMgY3JlYXRlZCgpIHsNCiAgICAgICAgYXdhaXQgdGhpcy5sb2FkQm9va3MoKTsNCiAgICAgICAgdGhpcy5jaGVja0FkbWluUm9sZSgpOw0KICAgIH0sDQogICAgbWV0aG9kczogew0KICAgICAgICBjaGVja0FkbWluUm9sZSgpIHsNCiAgICAgICAgICAgIGNvbnN0IHVzZXIgPSBhdXRoU2VydmljZS5nZXRDdXJyZW50VXNlcigpOw0KICAgICAgICAgICAgdGhpcy5pc0FkbWluID0gdXNlciAmJiB1c2VyLmNodWN2dSA9PT0gJ2FkbWluJzsNCiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdDdXJyZW50IHVzZXIgcm9sZTonLCB1c2VyICYmIHVzZXIuY2h1Y3Z1KTsNCiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdJcyBhZG1pbjonLCB0aGlzLmlzQWRtaW4pOw0KICAgICAgICB9LA0KICAgICAgICANCiAgICAgICAgYXN5bmMgbG9hZEJvb2tzKCkgew0KICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBhcGkuZ2V0KCcvc2FjaCcpOw0KICAgICAgICAgICAgICAgIHRoaXMuYm9va3MgPSByZXMuZGF0YTsNCiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnQm9va3MgbG9hZGVkOicsIHRoaXMuYm9va3MubGVuZ3RoKTsNCiAgICAgICAgICAgIH0gY2F0Y2ggKGVycikgew0KICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGxvYWRpbmcgYm9va3M6JywgZXJyKTsNCiAgICAgICAgICAgICAgICB0aGlzLiRidlRvYXN0LnRvYXN0KCdLaMO0bmcgdOG6o2kgxJHGsOG7o2MgZGFuaCBzw6FjaCBzw6FjaCcsIHsNCiAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICdM4buXaScsDQogICAgICAgICAgICAgICAgICAgIHZhcmlhbnQ6ICdkYW5nZXInLA0KICAgICAgICAgICAgICAgICAgICBzb2xpZDogdHJ1ZQ0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICANCiAgICAgICAgZm9ybWF0SW1hZ2VVcmwoaW1hZ2VVcmwpIHsNCiAgICAgICAgICAgIGlmICghaW1hZ2VVcmwpIHJldHVybiAnJzsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgaWYgKGltYWdlVXJsLnN0YXJ0c1dpdGgoJ2h0dHAnKSkgew0KICAgICAgICAgICAgICAgIHJldHVybiBpbWFnZVVybDsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIGBodHRwOi8vbG9jYWxob3N0OjMwMDAke2ltYWdlVXJsfWA7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgIA0KICAgICAgICBlZGl0Qm9vayhib29rKSB7DQogICAgICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaChgL2VkaXQtYm9vay8ke2Jvb2suTWFTYWNofWApOw0KICAgICAgICB9LA0KICAgICAgICANCiAgICAgICAgYXN5bmMgZGVsZXRlQm9vayhib29rKSB7DQogICAgICAgICAgICAvLyBMb2cgdGhlIGJvb2sgb2JqZWN0IGNvbXBsZXRlbHkgdG8gZGVidWcNCiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJCb29rIG9iamVjdCBmb3IgZGVsZXRpb246IiwgYm9vayk7DQogICAgICAgICAgICANCiAgICAgICAgICAgIGlmICghY29uZmlybShgQuG6oW4gY8OzIGNo4bqvYyBtdeG7kW4geG/DoSBzw6FjaCAiJHtib29rLlRlblNhY2h9IiAoTcOjOiAke2Jvb2suTWFTYWNofSk/YCkpIHJldHVybjsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8gVmFsaWRhdGUgYm9vay5NYVNhY2ggZXhpc3RzIGFuZCBpcyBub3QgZW1wdHkNCiAgICAgICAgICAgIGlmICghYm9vay5NYVNhY2gpIHsNCiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCJNYVNhY2ggZmllbGQgaXMgbWlzc2luZyIpOw0KICAgICAgICAgICAgICAgIHRoaXMuJGJ2VG9hc3QudG9hc3QoJ0tow7RuZyB0aOG7gyB4b8OhIHPDoWNoOiBNw6Mgc8OhY2gga2jDtG5nIHThu5NuIHThuqFpJywgew0KICAgICAgICAgICAgICAgICAgICB0aXRsZTogJ0zhu5dpIGThu68gbGnhu4d1JywNCiAgICAgICAgICAgICAgICAgICAgdmFyaWFudDogJ2RhbmdlcicsDQogICAgICAgICAgICAgICAgICAgIHNvbGlkOiB0cnVlDQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyBFbmhhbmNlZCB2YWxpZGF0aW9uIGZvciBNYVNhY2gNCiAgICAgICAgICAgIGNvbnN0IG9yaWdpbmFsTWFTYWNoID0gYm9vay5NYVNhY2g7DQogICAgICAgICAgICBjb25zdCBib29rSWQgPSB0eXBlb2Ygb3JpZ2luYWxNYVNhY2ggPT09ICdzdHJpbmcnID8gb3JpZ2luYWxNYVNhY2gudHJpbSgpIDogU3RyaW5nKG9yaWdpbmFsTWFTYWNoKS50cmltKCk7DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIENoZWNrIGZvciB3aGl0ZXNwYWNlIG9yIGNhc2UgZGlmZmVyZW5jZXMNCiAgICAgICAgICAgIGlmIChvcmlnaW5hbE1hU2FjaCAhPT0gYm9va0lkKSB7DQogICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGDimqDvuI8gTWFTYWNoIGNvbnRhaW5zIHdoaXRlc3BhY2UuIE9yaWdpbmFsOiAiJHtvcmlnaW5hbE1hU2FjaH0iLCBDbGVhbmVkOiAiJHtib29rSWR9ImApOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICBjb25zb2xlLmxvZyhg8J+UjSBNYVNhY2ggdmFsaWRhdGlvbiBjaGVja3M6YCk7DQogICAgICAgICAgICBjb25zb2xlLmxvZyhgICAtIE9yaWdpbmFsIHZhbHVlOiAiJHtvcmlnaW5hbE1hU2FjaH0iYCk7DQogICAgICAgICAgICBjb25zb2xlLmxvZyhgICAtIFRyaW1tZWQgdmFsdWU6ICIke2Jvb2tJZH0iYCk7DQogICAgICAgICAgICBjb25zb2xlLmxvZyhgICAtIENoYXJhY3RlciBjb2RlczogWyR7QXJyYXkuZnJvbShib29rSWQpLm1hcChjID0+IGMuY2hhckNvZGVBdCgwKSl9XWApOw0KICAgICAgICAgICAgDQogICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgIC8vIE1ha2Ugc3VyZSB3ZSdyZSB1c2luZyB0aGUgY29ycmVjdCBVUkwgZm9ybWF0IHdpdGggdGhlIGJvb2sgSUQNCiAgICAgICAgICAgICAgICBjb25zdCBkZWxldGVVcmwgPSBgL3NhY2gvJHtib29rSWR9YDsNCiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhg8J+TpCBTZW5kaW5nIERFTEVURSByZXF1ZXN0IHRvOiAke2FwaS5kZWZhdWx0cy5iYXNlVVJMfSR7ZGVsZXRlVXJsfWApOw0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgYXBpLmRlbGV0ZShkZWxldGVVcmwpOw0KICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJEZWxldGUgcmVzcG9uc2U6IiwgcmVzcG9uc2UuZGF0YSk7DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgdGhpcy4kYnZUb2FzdC50b2FzdCgnWG/DoSBzw6FjaCB0aMOgbmggY8O0bmcnLCB7DQogICAgICAgICAgICAgICAgICAgIHRpdGxlOiAnVGjDoG5oIGPDtG5nJywNCiAgICAgICAgICAgICAgICAgICAgdmFyaWFudDogJ3N1Y2Nlc3MnLA0KICAgICAgICAgICAgICAgICAgICBzb2xpZDogdHJ1ZQ0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIC8vIFJlbG9hZCBib29rIGxpc3QNCiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmxvYWRCb29rcygpOw0KICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7DQogICAgICAgICAgICAgICAgLy8gLi4uZXhpc3RpbmcgZXJyb3IgaGFuZGxpbmcgY29kZS4uLg0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIC8vIEFkZCBtb3JlIGRldGFpbGVkIDQwNCBlcnJvciBpbmZvcm1hdGlvbg0KICAgICAgICAgICAgICAgIGlmIChlcnIucmVzcG9uc2UgJiYgZXJyLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA0KSB7DQogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Jvb2sgbm90IGZvdW5kIGluIGRhdGFiYXNlIHdpdGggSUQ6JywgYm9vay5NYVNhY2gpOw0KICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnQm9vayBvYmplY3QgYmVpbmcgZGVsZXRlZDonLCBib29rKTsNCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIHRoaXMuJGJ2VG9hc3QudG9hc3QoYEtow7RuZyB0w6xtIHRo4bqleSBzw6FjaCB24bubaSBtw6MgIiR7Ym9vay5NYVNhY2h9IiB0cm9uZyBjxqEgc+G7nyBk4buvIGxp4buHdS4gVnVpIGzDsm5nIGzDoG0gbeG7m2kgdHJhbmcgdsOgIHRo4butIGzhuqFpLmAsIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiAnTOG7l2kga2jDtG5nIHTDrG0gdGjhuqV5IHPDoWNoJywNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhcmlhbnQ6ICd3YXJuaW5nJywNCiAgICAgICAgICAgICAgICAgICAgICAgIHNvbGlkOiB0cnVlDQogICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAvLyBMb2cgZGV0YWlsZWQgZXJyb3IgaW5mb3JtYXRpb24NCiAgICAgICAgICAgICAgICBpZiAoZXJyLnJlc3BvbnNlKSB7DQogICAgICAgICAgICAgICAgICAgIC8vIFNlcnZlciByZXNwb25kZWQgd2l0aCBhIHN0YXR1cyBjb2RlIG91dHNpZGUgb2YgMnh4IHJhbmdlDQogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHJlc3BvbnNlIGRhdGE6JywgZXJyLnJlc3BvbnNlLmRhdGEpOw0KICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciByZXNwb25zZSBzdGF0dXM6JywgZXJyLnJlc3BvbnNlLnN0YXR1cyk7DQogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHJlc3BvbnNlIGhlYWRlcnM6JywgZXJyLnJlc3BvbnNlLmhlYWRlcnMpOw0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgY29uc3QgZXJyb3JNZXNzYWdlID0gZXJyLnJlc3BvbnNlLmRhdGEubWVzc2FnZSB8fCANCiAgICAgICAgICAgICAgICAgICAgICAgIGBM4buXaSBtw6F5IGNo4bunOiAke2Vyci5yZXNwb25zZS5zdGF0dXN9YDsNCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIHRoaXMuJGJ2VG9hc3QudG9hc3QoYFhvw6Egc8OhY2ggdGjhuqV0IGLhuqFpOiAke2Vycm9yTWVzc2FnZX1gLCB7DQogICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogJ0zhu5dpJywNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhcmlhbnQ6ICdkYW5nZXInLA0KICAgICAgICAgICAgICAgICAgICAgICAgc29saWQ6IHRydWUNCiAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlcnIucmVxdWVzdCkgew0KICAgICAgICAgICAgICAgICAgICAvLyBSZXF1ZXN0IHdhcyBtYWRlIGJ1dCBubyByZXNwb25zZSByZWNlaXZlZA0KICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciByZXF1ZXN0OicsIGVyci5yZXF1ZXN0KTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy4kYnZUb2FzdC50b2FzdCgnWG/DoSBzw6FjaCB0aOG6pXQgYuG6oWk6IEtow7RuZyBuaOG6rW4gxJHGsOG7o2MgcGjhuqNuIGjhu5NpIHThu6sgbcOheSBjaOG7pycsIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiAnTOG7l2kga+G6v3QgbuG7kWknLA0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyaWFudDogJ2RhbmdlcicsDQogICAgICAgICAgICAgICAgICAgICAgICBzb2xpZDogdHJ1ZQ0KICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAvLyBTb21ldGhpbmcgZWxzZSBoYXBwZW5lZCB3aGlsZSBzZXR0aW5nIHVwIHRoZSByZXF1ZXN0DQogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIG1lc3NhZ2U6JywgZXJyLm1lc3NhZ2UpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLiRidlRvYXN0LnRvYXN0KGBYb8OhIHPDoWNoIHRo4bqldCBi4bqhaTogJHtlcnIubWVzc2FnZX1gLCB7DQogICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogJ0zhu5dpJywNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhcmlhbnQ6ICdkYW5nZXInLA0KICAgICAgICAgICAgICAgICAgICAgICAgc29saWQ6IHRydWUNCiAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIC8vIENoZWNrIGF1dGhlbnRpY2F0aW9uIHN0YXR1cw0KICAgICAgICAgICAgICAgIGlmIChlcnIucmVzcG9uc2UgJiYgZXJyLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDAxKSB7DQogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybignQXV0aGVudGljYXRpb24gaXNzdWUgZGV0ZWN0ZWQnKTsNCiAgICAgICAgICAgICAgICAgICAgY29uc3QgdG9rZW4gPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndG9rZW4nKTsNCiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0N1cnJlbnQgdG9rZW4gZXhpc3RzOicsICEhdG9rZW4pOw0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgdGhpcy4kYnZUb2FzdC50b2FzdCgnUGhpw6puIMSRxINuZyBuaOG6rXAgxJHDoyBo4bq/dCBo4bqhbiwgdnVpIGzDsm5nIMSRxINuZyBuaOG6rXAgbOG6oWknLCB7DQogICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogJ0zhu5dpIHjDoWMgdGjhu7FjJywNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhcmlhbnQ6ICd3YXJuaW5nJywNCiAgICAgICAgICAgICAgICAgICAgICAgIHNvbGlkOiB0cnVlDQogICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCn07DQo="},{"version":3,"sources":["BookList.vue"],"names":[],"mappings":";AAqBA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"BookList.vue","sourceRoot":"src/components/books","sourcesContent":["<template>\r\n    <b-container>\r\n        <h2>Danh sách sách</h2>\r\n        <b-table :items=\"books\" :fields=\"fields\" striped hover>\r\n            <!-- Template cho cột HinhAnh -->\r\n            <template #cell(HinhAnh)=\"data\">\r\n                <img v-if=\"data.value\" :src=\"formatImageUrl(data.value)\" alt=\"Book cover\" style=\"max-height: 50px;\" />\r\n            </template>\r\n            \r\n            <!-- Template cho cột actions -->\r\n            <template #cell(actions)=\"row\">\r\n                <div v-if=\"isAdmin\">\r\n                    <b-button size=\"sm\" variant=\"warning\" class=\"mr-1\" @click=\"editBook(row.item)\">Sửa</b-button>\r\n                    <b-button size=\"sm\" variant=\"danger\" @click=\"deleteBook(row.item)\">Xoá</b-button>\r\n                </div>\r\n            </template>\r\n        </b-table>\r\n    </b-container>\r\n</template>\r\n\r\n<script>\r\nimport api from '@/api';\r\nimport authService from '@/services/auth.service';\r\n\r\nexport default {\r\n    data() {\r\n        return {\r\n            books: [],\r\n            fields: [\r\n                { key: 'MaSach', label: 'Mã sách' },\r\n                { key: 'TenSach', label: 'Tên sách' },\r\n                { key: 'TacGia', label: 'Tác giả' },\r\n                { key: 'HinhAnh', label: 'Hình ảnh' },\r\n                { key: 'actions', label: 'Hành động' }\r\n            ],\r\n            isAdmin: false\r\n        };\r\n    },\r\n    async created() {\r\n        await this.loadBooks();\r\n        this.checkAdminRole();\r\n    },\r\n    methods: {\r\n        checkAdminRole() {\r\n            const user = authService.getCurrentUser();\r\n            this.isAdmin = user && user.chucvu === 'admin';\r\n            console.log('Current user role:', user && user.chucvu);\r\n            console.log('Is admin:', this.isAdmin);\r\n        },\r\n        \r\n        async loadBooks() {\r\n            try {\r\n                const res = await api.get('/sach');\r\n                this.books = res.data;\r\n                console.log('Books loaded:', this.books.length);\r\n            } catch (err) {\r\n                console.error('Error loading books:', err);\r\n                this.$bvToast.toast('Không tải được danh sách sách', {\r\n                    title: 'Lỗi',\r\n                    variant: 'danger',\r\n                    solid: true\r\n                });\r\n            }\r\n        },\r\n        \r\n        formatImageUrl(imageUrl) {\r\n            if (!imageUrl) return '';\r\n            \r\n            if (imageUrl.startsWith('http')) {\r\n                return imageUrl;\r\n            } else {\r\n                return `http://localhost:3000${imageUrl}`;\r\n            }\r\n        },\r\n        \r\n        editBook(book) {\r\n            this.$router.push(`/edit-book/${book.MaSach}`);\r\n        },\r\n        \r\n        async deleteBook(book) {\r\n            // Log the book object completely to debug\r\n            console.log(\"Book object for deletion:\", book);\r\n            \r\n            if (!confirm(`Bạn có chắc muốn xoá sách \"${book.TenSach}\" (Mã: ${book.MaSach})?`)) return;\r\n            \r\n            // Validate book.MaSach exists and is not empty\r\n            if (!book.MaSach) {\r\n                console.error(\"MaSach field is missing\");\r\n                this.$bvToast.toast('Không thể xoá sách: Mã sách không tồn tại', {\r\n                    title: 'Lỗi dữ liệu',\r\n                    variant: 'danger',\r\n                    solid: true\r\n                });\r\n                return;\r\n            }\r\n            \r\n            // Enhanced validation for MaSach\r\n            const originalMaSach = book.MaSach;\r\n            const bookId = typeof originalMaSach === 'string' ? originalMaSach.trim() : String(originalMaSach).trim();\r\n            \r\n            // Check for whitespace or case differences\r\n            if (originalMaSach !== bookId) {\r\n                console.warn(`⚠️ MaSach contains whitespace. Original: \"${originalMaSach}\", Cleaned: \"${bookId}\"`);\r\n            }\r\n            \r\n            console.log(`🔍 MaSach validation checks:`);\r\n            console.log(`  - Original value: \"${originalMaSach}\"`);\r\n            console.log(`  - Trimmed value: \"${bookId}\"`);\r\n            console.log(`  - Character codes: [${Array.from(bookId).map(c => c.charCodeAt(0))}]`);\r\n            \r\n            try {\r\n                // Make sure we're using the correct URL format with the book ID\r\n                const deleteUrl = `/sach/${bookId}`;\r\n                console.log(`📤 Sending DELETE request to: ${api.defaults.baseURL}${deleteUrl}`);\r\n                \r\n                const response = await api.delete(deleteUrl);\r\n                console.log(\"Delete response:\", response.data);\r\n                \r\n                this.$bvToast.toast('Xoá sách thành công', {\r\n                    title: 'Thành công',\r\n                    variant: 'success',\r\n                    solid: true\r\n                });\r\n                \r\n                // Reload book list\r\n                await this.loadBooks();\r\n            } catch (err) {\r\n                // ...existing error handling code...\r\n                \r\n                // Add more detailed 404 error information\r\n                if (err.response && err.response.status === 404) {\r\n                    console.error('Book not found in database with ID:', book.MaSach);\r\n                    console.log('Book object being deleted:', book);\r\n                    \r\n                    this.$bvToast.toast(`Không tìm thấy sách với mã \"${book.MaSach}\" trong cơ sở dữ liệu. Vui lòng làm mới trang và thử lại.`, {\r\n                        title: 'Lỗi không tìm thấy sách',\r\n                        variant: 'warning',\r\n                        solid: true\r\n                    });\r\n                }\r\n                \r\n                // Log detailed error information\r\n                if (err.response) {\r\n                    // Server responded with a status code outside of 2xx range\r\n                    console.error('Error response data:', err.response.data);\r\n                    console.error('Error response status:', err.response.status);\r\n                    console.error('Error response headers:', err.response.headers);\r\n                    \r\n                    const errorMessage = err.response.data.message || \r\n                        `Lỗi máy chủ: ${err.response.status}`;\r\n                    \r\n                    this.$bvToast.toast(`Xoá sách thất bại: ${errorMessage}`, {\r\n                        title: 'Lỗi',\r\n                        variant: 'danger',\r\n                        solid: true\r\n                    });\r\n                } else if (err.request) {\r\n                    // Request was made but no response received\r\n                    console.error('Error request:', err.request);\r\n                    this.$bvToast.toast('Xoá sách thất bại: Không nhận được phản hồi từ máy chủ', {\r\n                        title: 'Lỗi kết nối',\r\n                        variant: 'danger',\r\n                        solid: true\r\n                    });\r\n                } else {\r\n                    // Something else happened while setting up the request\r\n                    console.error('Error message:', err.message);\r\n                    this.$bvToast.toast(`Xoá sách thất bại: ${err.message}`, {\r\n                        title: 'Lỗi',\r\n                        variant: 'danger',\r\n                        solid: true\r\n                    });\r\n                }\r\n                \r\n                // Check authentication status\r\n                if (err.response && err.response.status === 401) {\r\n                    console.warn('Authentication issue detected');\r\n                    const token = localStorage.getItem('token');\r\n                    console.log('Current token exists:', !!token);\r\n                    \r\n                    this.$bvToast.toast('Phiên đăng nhập đã hết hạn, vui lòng đăng nhập lại', {\r\n                        title: 'Lỗi xác thực',\r\n                        variant: 'warning',\r\n                        solid: true\r\n                    });\r\n                }\r\n            }\r\n        }\r\n    }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.table-responsive {\r\n    overflow-x: auto;\r\n}\r\n</style>\r\n"]}]}